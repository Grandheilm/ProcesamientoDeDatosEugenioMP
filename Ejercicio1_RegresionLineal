import matplotlib
matplotlib.use('TkAgg')

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score

# Cargar datos
data = pd.read_csv("CopierSalesofAmerica.csv")

print(data.shape)
print(data.head())

# Variables
X = np.array(data['llamadas']).reshape(-1, 1)
y = np.array(data['ventas'])

# Modelo
modelo = LinearRegression()
modelo.fit(X, y)

# Predicción
y_pred = modelo.predict(X)

# Gráfica
x = X.ravel()

plt.figure(figsize=(8, 5))
plt.scatter(x, y, label='Datos')
plt.plot(x, y_pred, label='Regresión')

plt.xlabel('No. de llamadas')
plt.ylabel('Copiadoras vendidas')
plt.title('Copier Sales of America')
plt.legend()
plt.grid(True)
plt.show()

# Métricas
print("Pendiente:", modelo.coef_[0])
print("Intercepto:", modelo.intercept_)
print("MSE:", mean_squared_error(y, y_pred))
print("R²:", r2_score(y, y_pred))